import React, { useEffect, useRef } from "react";
import anime from "animejs";

import "./scroll-12.scss";

const Scroll12 = () => {
  const path = useRef(null);

  useEffect(() => {
    const scrollHandler = () => {
      /*
        Ð¨Ñ‚Ñ€Ð¸Ñ… ÑÐ¼ÐµÑ‰Ð°ÐµÑ‚ÑÑ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ñ‹ÑÑ‚Ñ€Ð¾. Ð§Ñ‚Ð¾Ð±Ñ‹ ÑÑ‚Ð¾ Ð¿Ð¾Ñ‡Ð¸Ð½Ð¸Ñ‚ÑŒ, Ð½Ð°Ð¹Ð´Ñ‘Ð¼
        ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ â€” Ð²Ð¾ ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð· Ð´Ð»Ð¸Ð½Ð° path Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¸Ð»Ð¸ Ð¼ÐµÐ½ÑŒÑˆÐµ Ð²Ñ‹ÑÐ¾Ñ‚Ñ‹ body.

        Ð’Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÑŒ Ð´Ð»Ð¸Ð½Ñƒ path Ð½Ð°Ð¼ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ð¾Ð´ getTotalLength().
        Ð’Ñ‹Ñ‡Ð¸ÑÐ»Ð¸Ñ‚ÑŒ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¼Ð¾Ð¶Ð½Ð¾, Ð¿Ð¾Ð´ÐµÐ»Ð¸Ð² Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð½Ð° Ð´Ð»Ð¸Ð½Ñƒ path.

        ÐžÑÑ‚Ð°Ð½ÐµÑ‚ÑÑ Ð² Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ñƒ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð° Ð¾Ñ‚ÑÑ‚ÑƒÐ¿Ð° Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹
        Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ Ð½Ð° Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ð¹ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚.
      */
      const delta = document.body.offsetHeight / path.current.getTotalLength();
      /*
        ÐžÐºÑ€ÑƒÐ³Ð»ÑÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ Ð¸ Ð´ÐµÐ»Ð°ÐµÐ¼ ÐµÐ³Ð¾ Ð¾Ñ‚Ñ€Ð¸Ñ†Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¼.
        Ð”Ð°Ð»ÐµÐµ Ð´ÐµÐ»Ð¸Ð¼ Ð½Ð° delta.
      */

      /*
        ÐšÐ°Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ delta.

        ðŸ“Œ Ð¡ÑƒÑ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð±ÐµÐ· ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð°:

            Ð‘ÐµÐ· Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ delta Ñƒ Ð²Ð°Ñ Ð¿Ñ€Ð¾Ð¸ÑÑ…Ð¾Ð´Ð¸Ñ‚ Ð½ÐµÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¾Ð²:

            Ð”Ð»Ð¸Ð½Ð° Ð¿ÑƒÑ‚Ð¸ SVG (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 1500px Ñ‡ÐµÑ€ÐµÐ· getTotalLength())

            Ð’Ñ‹ÑÐ¾Ñ‚Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 5000px)

            ÐŸÑ€Ð¸ ÑÐºÑ€Ð¾Ð»Ð»Ðµ Ð½Ð° 5000px ÑˆÑ‚Ñ€Ð¸Ñ… Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð¿Ñ€Ð¾Ð¹Ñ‚Ð¸ Ð²ÐµÑÑŒ Ð¿ÑƒÑ‚ÑŒ Ð´Ð»Ð¸Ð½Ð¾Ð¹ 1500px, Ð½Ð¾ Ð±ÐµÐ· Ð¼Ð°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¼Ñƒ Ð¿Ð¸ÐºÑÐµÐ»ÑŽ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ 1px ÑÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ ÑˆÑ‚Ñ€Ð¸Ñ…Ð°. Ð­Ñ‚Ð¾ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¸Ñ‚ Ðº:

            Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð¼Ñƒ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸ÑŽ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ð¸ (ÑˆÑ‚Ñ€Ð¸Ñ… "ÑƒÐ±ÐµÐ³Ð°ÐµÑ‚" Ð·Ð° 1500px Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸)

            ÐŸÑƒÑÑ‚Ð¾Ð¼Ñƒ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²Ñƒ Ð½Ð¸Ð¶Ðµ (Ð¾ÑÑ‚Ð°Ð²ÑˆÐ¸ÐµÑÑ 3500px Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ Ð±ÐµÐ· Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ð¸)

        ðŸ”„ ÐšÐ°Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ delta

        const delta = document.body.offsetHeight / pathLength;

        Ð¤Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐ¼Ñ‹ÑÐ»: "Ð¡ÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¿Ð¸ÐºÑÐµÐ»ÐµÐ¹ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ 1px Ð¿ÑƒÑ‚Ð¸ SVG"

        ÐŸÑ€Ð¸Ð¼ÐµÑ€:

        Ð’Ñ‹ÑÐ¾Ñ‚Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° = 5000px

        Ð”Ð»Ð¸Ð½Ð° Ð¿ÑƒÑ‚Ð¸ = 1500px

        delta = 5000 / 1500 â‰ˆ 3.33

        ðŸŽ¯ ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ ÑÑ‚Ð¾ Ñ€ÐµÑˆÐ°ÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ
        Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÐµÐ¹:

        const offset = -Math.floor(window.pageYOffset / delta);
        ÐšÐ°Ð¶Ð´Ñ‹Ðµ 3.33px Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸ Ð´Ð°ÑŽÑ‚ 1px ÑÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ ÑˆÑ‚Ñ€Ð¸Ñ…Ð°

        ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° (5000px) = Ð¿Ð¾Ð»Ð½Ð¾Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ðµ Ð¿ÑƒÑ‚Ð¸ (1500px)

        Ð­Ñ„Ñ„ÐµÐºÑ‚ "Ð¿Ñ€Ð¸Ð»Ð¸Ð¿Ð°Ð½Ð¸Ñ":

        ÐŸÑ€Ð¸ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð¼ ÑÐºÑ€Ð¾Ð»Ð»Ðµ Ð°Ð½Ð¸Ð¼Ð°Ñ†Ð¸Ñ ÑÐ»ÐµÐ´ÑƒÐµÑ‚ Ñ Ð¿Ñ€Ð¾Ð¿Ð¾Ñ€Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾ ÑƒÐ¼ÐµÐ½ÑŒÑˆÐµÐ½Ð½Ð¾Ð¹ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒÑŽ

        Ð’Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¾ ÑÐ¾Ð·Ð´Ð°ÐµÑ‚ÑÑ Ð²Ð¿ÐµÑ‡Ð°Ñ‚Ð»ÐµÐ½Ð¸Ðµ, Ñ‡Ñ‚Ð¾ ÑˆÑ‚Ñ€Ð¸Ñ… "Ð¿Ñ€Ð¸Ð»Ð¸Ð¿Ð°ÐµÑ‚" Ðº Ð³Ñ€Ð°Ð½Ð¸Ñ†Ðµ ÑÐºÑ€Ð°Ð½Ð°
      */
      const offset = -Math.floor(window.pageYOffset / delta);

      anime({
        targets: path.current,
        strokeDashoffset: [offset],
        easing: "easeInOutCubic",
        duration: 10,
      });
    };
    window.addEventListener("scroll", scrollHandler);

    return () => {
      window.removeEventListener("scroll", scrollHandler);
    };
  }, []);

  return (
    <div className="scroll-12">
      <div className="wrapper">
        <svg viewBox="0 0 100 1000">
          <path
            ref={path}
            fill="none"
            stroke="#483D8BFF"
            strokeWidth="2"
            strokeDasharray="200 1504"
            strokeDashoffset="50"
            strokeLinecap="round"
            d="M96.4354 1.64424C84.0938 10.6631 75.5952 25.0234 67.4631 37.6066C50.003 64.624 32.2974 91.9479 18.4403 121.028C12.1426 134.244 2.38231 151.886 1.70073 167.108C1.17676 178.81 5.51029 191.39 8.69086 202.335C15.1749 224.646 22.5624 246.645 31.5008 268.097C56.6128 328.366 76.4422 392.466 71.2341 458.946C69.0084 487.357 54.6656 517.763 39.9625 541.724C32.9963 553.076 27.3664 562.75 23.9588 575.939C19.7324 592.296 19.7179 609.751 25.4304 625.789C29.6709 637.695 39.4127 642.806 50.0798 648.139C83.7541 664.976 102.144 694.803 107.564 732.205C112.942 769.313 97.0739 800.228 93.4922 836.045C90.7991 862.976 91.4687 890.136 91.4687 917.167"
          />
        </svg>
      </div>
    </div>
  );
};

export { Scroll12 };
